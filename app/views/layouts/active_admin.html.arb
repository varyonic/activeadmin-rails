insert_tag Arbre::HTML::Document do
  head do
    render partial: 'active_admin/head',
           locals: {
              page_title: content_for(:page_title) || page_title,
              site_title: helpers.active_admin_namespace.site_title(self)
            }
  end
  body(class: body_classes) do
    div id: "wrapper" do
      if active_admin_namespace.unsupported_browser_matcher =~ controller.request.user_agent
        unsupported_browser
      end
      header active_admin_namespace, current_menu
      render partial: 'title_bar', locals: { page_title: content_for(:page_title) || page_title }
      div class: 'flashes' do
        flash_messages.each do |type, message|
          div message, class: "flash flash_#{type}"
        end
      end
      # div with main content plus possibly sidebars
      @skip_sidebar = sidebar_sections_for_action.empty? || assigns[:skip_sidebar] == true
      div id: "active_admin_content", class: (@skip_sidebar ? "without_sidebar" : "with_sidebar") do
        div id: "main_content_wrapper" do
          yield
        end
        sidebar sidebar_sections_for_action, id: 'sidebar' unless @skip_sidebar
      end
      footer active_admin_namespace
    end
  end
end
