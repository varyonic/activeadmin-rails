insert_tag Arbre::HTML::Document do
  head do
    render partial: 'active_admin/head',
           locals: {
              page_title: content_for(:page_title) || page_title,
              site_title: helpers.active_admin_namespace.site_title(self)
            }
  end
  body(class: body_classes) do
    div id: "wrapper" do
      if active_admin_namespace.unsupported_browser_matcher =~ controller.request.user_agent
        render partial: 'unsupported_browser'
      end
      render partial: 'header', locals: { namespace: active_admin_namespace, menu: current_menu }
      render partial: 'title_bar', locals: { page_title: content_for(:page_title) || page_title }
      div class: 'flashes' do
        flash_messages.each do |type, message|
          div message, class: "flash flash_#{type}"
        end
      end
      # div with main content plus possibly sidebars
      sidebar_sections = sidebar_sections_for_action unless skip_sidebar?
      div id: 'active_admin_content', class: (sidebar_sections.present? ? 'with_sidebar' : 'without_sidebar') do
        div id: 'main_content_wrapper' do
          yield
        end
        render partial: 'sidebar', locals: { sections: sidebar_sections } if sidebar_sections.present?
      end
      footer active_admin_namespace
    end
  end
end
